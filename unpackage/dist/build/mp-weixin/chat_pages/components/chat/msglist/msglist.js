require('../../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["chat_pages/components/chat/msglist/msglist"],{"3fc7":function(t,e,n){"use strict";(function(t){var s=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=s(n("7037")),a=n("e4a8"),o=n("aafc"),r={SHORT:"scroll_view_change",NORMAL:"scroll_view"},c=0,g=!1,u={data:function(){return{view:r.NORMAL,toView:"",chatMsg:[],__visibility__:!1,isIPX:!1,myAvatar:"",eAvatar:"/chat_pages/static/images/theme2x.png"}},components:{audioMsg:function(){Promise.all([n.e("chat_pages/common/vendor"),n.e("chat_pages/components/chat/msglist/type/audio/audio")]).then(function(){return resolve(n("0b96"))}.bind(null,n)).catch(n.oe)}},props:{username:{type:Object,default:function(){return{}}}},created:function(){},beforeMount:function(){this.__visibility__=!0,0,c=0},moved:function(){},destroyed:function(){this.__visibility__=!1,a.off("newChatMsg",this.dispMsg)},mounted:function(e){var n=t.getStorageSync("userInfo");console.log(n.avatar),this.myAvatar=n.avatar||"/chat_pages/static/images/theme22x.png";getApp().globalData.isIPX&&this.setData({isIPX:!0}),this.username=t.username;var s=this.username,i=t.getStorageSync("myUsername"),r=s.groupId?s.groupId+i:s.your+i,c=t.getStorageSync(r)||[];this.renderMsg(null,null,c,r),t.setStorageSync(r,null),o.on("em.error.sendMsgErr",(function(t){g=!0,console.log("发送失败了")})),a.on("newChatMsg",this.dispMsg)},methods:{toPositionDetails:function(e){var n={id:e,type:1};t.navigateTo({url:"/pages/position/job_detail?e="+JSON.stringify(n)})},jumpInterview_details:function(e){t.navigateTo({url:"/pages/news/interview_details?id="+e})},normalScroll:function(){this.setData({view:r.NORMAL})},dispMsg:function(e,n,s,i){var a=this.username,o=t.getStorageSync("myUsername"),r=a.groupId?a.groupId+o:a.your+o;this.curChatMsg=s,this.__visibility__&&(a.groupId?e.info.from!=a.groupId&&e.info.to!=a.groupId||i==r&&this.renderMsg(e,n,s,r,"newMsg"):e.info.from!=a.your&&e.info.to!=a.your||i==r&&this.renderMsg(e,n,s,r,"newMsg"))},shortScroll:function(){this.setData({view:r.SHORT})},onTap:function(){this.$emit("msglistTap",null,{bubbles:!0})},previewImage:function(e){var n=e.target.dataset.url;t.previewImage({urls:[n]})},getHistoryMsg:function(){var e=this.username,n=t.getStorageSync("myUsername"),s=e.groupId?e.groupId+n:e.your+n,i=t.getStorageSync("rendered_"+s)||[];if(c<i.length){var a=i.slice(-c-10,-c);this.setData({chatMsg:a.concat(this.chatMsg),toView:a[a.length-1].mid}),c+=a.length,10==a.length&&0,t.stopPullDownRefresh()}},renderMsg:function(e,n,s,i,a){var o=t.getStorageSync("rendered_"+i)||[];if(o=o.concat(s),o.length){o.forEach((function(t){var e;"self"==t.style&&0==(null===(e=t.msg.ext)||void 0===e?void 0:e.type)&&(console.log(t),t.isType=1,t.isContent={admin:JSON.parse(t.msg.ext.admin),position:JSON.parse(t.msg.ext.position)},""!=t.isContent.position.ask_json&&(t.isContent.position.ask_json=JSON.parse(t.isContent.position.ask_json)))})),console.log(o),"newMsg"==a?this.setData({chatMsg:this.chatMsg.concat(s),toView:o[o.length-1].mid}):this.setData({chatMsg:o.slice(-10),toView:o[o.length-1].mid}),t.setStorageSync("rendered_"+i,o);var r=t.getStorageSync(i)||[];r.map((function(t,e){s.map((function(n,s){n.mid==t.mid&&r.splice(e,1)}))})),t.setStorageSync(i,r),c=o.slice(-10).length,setTimeout((function(){t.pageScrollTo({scrollTop:5e3,duration:300,fail:function(t){}})}),100),g&&this.renderFail(i)}},renderFail:function(e){var n=this,s=n.chatMsg;s.map((function(t){t.mid.substring(t.mid.length-10)=="".substring("".length-10)&&(t.msg.data[0].isFail=!0,t.isFail=!0,n.setData({chatMsg:s}))})),""==n.curChatMsg[0].mid&&(n.curChatMsg[0].msg.data[0].isShow=!1,n.curChatMsg[0].isShow=!1),t.setStorageSync("rendered_"+e,s),g=!1},clickMsg:function(t){"object"==(0,i.default)(t.target.dataset.msg)&&t.target.dataset.msg.msg.ext&&t.target.dataset.msg.msg.ext.msg_extension&&this.$emit("clickMsg",t.target.dataset.msg.msg.ext)}}};e.default=u}).call(this,n("543d")["default"])},"75d7":function(t,e,n){"use strict";n.r(e);var s=n("3fc7"),i=n.n(s);for(var a in s)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return s[t]}))}(a);e["default"]=i.a},"79ff":function(t,e,n){"use strict";var s=n("e9a8"),i=n.n(s);i.a},df3c:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var s=function(){var t=this.$createElement;this._self._c},i=[]},e9a8:function(t,e,n){},ef71:function(t,e,n){"use strict";n.r(e);var s=n("df3c"),i=n("75d7");for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n("79ff");var o=n("f0c5"),r=Object(o["a"])(i["default"],s["b"],s["c"],!1,null,"6d824558",null,!1,s["a"],void 0);e["default"]=r.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'chat_pages/components/chat/msglist/msglist-create-component',
    {
        'chat_pages/components/chat/msglist/msglist-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("ef71"))
        })
    },
    [['chat_pages/components/chat/msglist/msglist-create-component']]
]);
