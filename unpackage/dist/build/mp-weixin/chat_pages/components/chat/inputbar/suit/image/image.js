require('../../../../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["chat_pages/components/chat/inputbar/suit/image/image"],{"17e7":function(e,t,n){"use strict";n.r(t);var a=n("bde5"),o=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=o.a},"42df":function(e,t,n){"use strict";n.r(t);var a=n("4afb"),o=n("17e7");for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var s=n("f0c5"),c=Object(s["a"])(o["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);t["default"]=c.exports},"4afb":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){}));var a=function(){var e=this.$createElement;this._self._c},o=[]},bde5:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n("9754")["default"],o=n("cc4a"),i=n("aafc"),s=n("e4a8"),c={data:function(){return{}},components:{},props:{username:{type:Object,default:function(){return{}}},chatType:{type:String,default:o.chatType.SINGLE_CHAT}},methods:{openCamera:function(){var t=this;e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["camera"],success:function(e){t.upLoadImage(e)}})},sendImage:function(){var t=this;e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(e){console.log("选择的图片",e),t.upLoadImage(e)}})},isGroupChat:function(){return this.chatType==o.chatType.CHAT_ROOM},getSendToParam:function(){return this.isGroupChat()?this.username.groupId:this.username.your},upLoadImage:function(t){var n=this,s=t.tempFilePaths,c=a.conn.context.accessToken;e.getImageInfo({src:t.tempFilePaths[0],success:function(t){var u={jpg:!0,jpeg:!0,gif:!0,png:!0,bmp:!0},r=a.config.appkey.split("#"),p=t.width,f=t.height,l=t.path.lastIndexOf(".");console.log("index>>",l);var d=~l&&t.path.slice(l+1)||"";t.type||e.showToast({title:"H5端，uni-app暂未支持",icon:"none"}),(d.toLowerCase()in u||t.type in u)&&e.uploadFile({url:"https://a1.easemob.com/"+r[0]+"/"+r[1]+"/chatfiles",filePath:s[0],fileType:"image",name:"file",header:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+c},success:function(t){if(console.log("上传图片成功",t),400==t.statusCode)return e.showToast({title:"图片检测不合法",duration:1e3}),!1;var c=t.data,u=JSON.parse(c),r=a.conn.getUniqueId(),l=new a.message(o.IMAGE,r),h={type:o.IMAGE,size:{width:p,height:f},url:u.uri+"/"+u.entities[0].uuid,filetype:d,filename:s[0]};l.set({apiUrl:a.config.apiURL,body:h,from:n.username.myName,to:n.getSendToParam(),roomType:!1,chatType:n.chatType,success:function(e){i.fire("em.chat.sendSuccess",r)}}),n.chatType==o.chatType.CHAT_ROOM&&l.setGroup("groupchat"),a.conn.send(l.body);var m={msg:l,type:o.IMAGE};n.saveSendMsg(m)},fail:function(e){console.log("上传失败",e)},complete:function(e){console.log("上传完成",e)}})}})},saveSendMsg:function(e){s.saveMsg(e.msg,e.type)}}};t.default=c}).call(this,n("543d")["default"])}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'chat_pages/components/chat/inputbar/suit/image/image-create-component',
    {
        'chat_pages/components/chat/inputbar/suit/image/image-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("42df"))
        })
    },
    [['chat_pages/components/chat/inputbar/suit/image/image-create-component']]
]);
